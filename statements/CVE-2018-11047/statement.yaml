vulnerability_id: CVE-2018-11047
notes:
- text: Cloud Foundry UAA, versions 4.19 prior to 4.19.2 and 4.12 prior to 4.12.4 and 4.10 prior to 4.10.2 and 4.7 prior to 4.7.6 and 4.5 prior to 4.5.7, incorrectly authorizes requests to admin endpoints by accepting a valid refresh token in lieu of an access token. Refresh tokens by design have a longer expiration time than access tokens, allowing the possessor of a refresh token to authenticate longer than expected. This affects the administrative endpoints of the UAA. i.e. /Users, /Groups, etc. However, if the user has been deleted or had groups removed, or the client was deleted, the refresh token will no longer be valid.
fixes:
- id: prerelease/4.12.x
  commits:
  - id: bbbba5aec514ad88e7d1e168a2519c80229f02f
    repository: https://github.com/cloudfoundry/uaa
- id: prerelease/4.19.x
  commits:
  - id: 2906057dae995024576ce6afdc20abd85569514
    repository: https://github.com/cloudfoundry/uaa
- id: prerelease/4.10.x
  commits:
  - id: 81aeb7a3aa048ea086c494f725d643e48dd9266
    repository: https://github.com/cloudfoundry/uaa
- id: prerelease/4.5.x
  commits:
  - id: a1d523c7f150e56bf06df8b83ed1d416d6c1d3b
    repository: https://github.com/cloudfoundry/uaa
- id: prerelease/4.7.x
  commits:
  - id: aba1fb5f18e0d628628b2d960fc6d0cc62d86f5
    repository: https://github.com/cloudfoundry/uaa
compile_info:
- id: prerelease/4.12.x
  exclusions:
  - name: spring-core
    version: 2.5.6
- id: prerelease/4.19.x
  exclusions:
  - name: spring-core
    version: 2.5.6
- id: prerelease/4.10.x
  exclusions:
  - name: spring-core
    version: 2.5.6
  - name: spring-core
    version: 3.0.7.RELEASE
- id: prerelease/4.5.x
  exclusions:
  - name: spring-core
    version: 2.5.6
  - name: spring-core
    version: 3.0.7.RELEASE
- id: prerelease/4.7.x
  exclusions:
  - name: spring-core
    version: 2.5.6
  - name: spring-core
    version: 3.0.7.RELEASE
  supplements:
  - groupId: org.cloudfoundry.identity
    artifactId: cloudfoundry-identity-metrics-data
    version: 4.7.6
artifacts:
- id: pkg:maven/org.cloudfoundry.identity/cloudfoundry-identity-server@4.6.1
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.cloudfoundry.identity/cloudfoundry-identity-server@4.19.2
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.cloudfoundry.identity/cloudfoundry-identity-server@4.7.1
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.cloudfoundry.identity/cloudfoundry-identity-server@4.7.2
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.cloudfoundry.identity/cloudfoundry-identity-server@4.7.4
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.cloudfoundry.identity/cloudfoundry-identity-server@4.20.0
  reason: Reviewed manually
  affected: false
- id: pkg:maven/org.cloudfoundry.identity/cloudfoundry-identity-server@4.11.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.cloudfoundry.identity/cloudfoundry-identity-server@4.12.2
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.cloudfoundry.identity/cloudfoundry-identity-server@4.12.3
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.cloudfoundry.identity/cloudfoundry-identity-server@4.19.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
