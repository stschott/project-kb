vulnerability_id: CVE-2017-5638
notes:
  - text: "The Jakarta Multipart parser in Apache Struts 2 2.3.x before 2.3.32 and 2.5.x before 2.5.10.1 has incorrect exception handling and error-message generation during file-upload attempts, which allows remote attackers to execute arbitrary commands via a crafted Content-Type, Content-Disposition, or Content-Length HTTP header, as exploited in the wild in March 2017 with a Content-Type header containing a #cmd= string."
fixes:
  - id: support-2-3
    commits:
      - id: 352306493971e7d5a756d61780d57a76eb1f519a
        repository: https://gitbox.apache.org/repos/asf/struts.git
  - id: DEFAULT_BRANCH
    commits:
      - id: 6b8272ce47160036ed120a48345d9aa884477228
        repository: https://gitbox.apache.org/repos/asf/struts.git
compile_info:
- id: support-2-3
  exclusions:
  - name: commons-fileupload
    version: "1.0"
- id: DEFAULT_BRANCH
  exclusions:
  - name: commons-fileupload
    version: "1.0"
artifacts:
  - id: pkg:maven/org.apache.struts/struts2-core@2.0.5
    reason: Reviewed manually
    affected: false
  - id: pkg:maven/org.apache.struts/struts2-core@2.2.3
    reason: Reviewed manually
    affected: false
  - id: pkg:maven/org.apache.struts/struts2-core@2.2.1
    reason: Reviewed manually
    affected: false
  - id: pkg:maven/org.apache.struts/struts2-core@2.3.15
    reason: Assessed with Eclipse Steady (AST_EQUALITY)
    affected: true
  - id: pkg:maven/org.apache.struts/struts2-core@2.5.17
    reason: Assessed with Eclipse Steady (AST_EQUALITY)
    affected: false
  - id: pkg:maven/org.apache.struts/struts2-core@2.3.24
    reason: Assessed with Eclipse Steady (AST_EQUALITY)
    affected: true
  - id: pkg:maven/org.apache.struts/struts2-core@2.3.35
    reason: Assessed with Eclipse Steady (AST_EQUALITY)
    affected: false
  - id: pkg:maven/org.apache.struts/struts2-core@2.3.20
    reason: Assessed with Eclipse Steady (AST_EQUALITY)
    affected: true
  - id: pkg:maven/org.apache.struts/struts2-core@2.3.31
    reason: Assessed with Eclipse Steady (AST_EQUALITY)
    affected: true
  - id: pkg:maven/org.apache.struts/struts2-core@2.3.32
    reason: Assessed with Eclipse Steady (AST_EQUALITY)
    affected: false
  - id: pkg:maven/org.apache.struts/struts2-core@2.5.22
    reason: Assessed with Eclipse Steady (AST_EQUALITY)
    affected: false
  - id: pkg:maven/org.apache.struts/struts2-core@2.2.3.1
    reason: Reviewed manually
    affected: false
  - id: pkg:maven/org.apache.struts/struts2-core@2.5.14.1
    reason: Assessed with Eclipse Steady (AST_EQUALITY)
    affected: false
