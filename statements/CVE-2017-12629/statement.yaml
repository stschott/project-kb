vulnerability_id: CVE-2017-12629
notes:
- text: Remote code execution occurs in Apache Solr before 7.1 with Apache Lucene before 7.1 by exploiting XXE in conjunction with use of a Config API add-listener command to reach the RunExecutableListener class. Elasticsearch, although it uses Lucene, is NOT vulnerable to this. Note that the XML external entity expansion vulnerability occurs in the XML Query Parser which is available, by default, for any query request with parameters deftype=xmlparser and can be exploited to upload malicious data to the /upload request handler or as Blind XXE using ftp wrapper in order to read arbitrary local files from the Solr server. Note also that the second vulnerability relates to remote code execution using the RunExecutableListener available on all affected versions of Solr.
fixes:
- id: master
  commits:
  - id: 926cc4d65b6d2cc40ff07f76d50ddeda947e3cc
    repository: https://github.com/apache/lucene-solr
- id: branch_7_2
  commits:
  - id: d28baa3fc5566b47f1ca7cc2ba1aba658dc634a
    repository: https://github.com/apache/lucene-solr
- id: branch_5_5
  commits:
  - id: d8000beebfb13ba0b6e754f84c760e11592d8d1
    repository: https://github.com/apache/lucene-solr
- id: branch_6_6
  commits:
  - id: f9fd6e9e26224f26f1542224ce187e04c27b268
    repository: https://github.com/apache/lucene-solr
- id: branch_7_1
  commits:
  - id: 3bba91131b5257e64b9d0a2193e1e32a145b2a2
    repository: https://github.com/apache/lucene-solr
compile_info:
- id: master
  coordinates:
    groupId: org.apache.solr
    artifactId: solr-core
    version: 7.0.0
  exclusions:
  - name: slf4j-api
    version: 1.6.1
- id: branch_5_5
  coordinates:
    groupId: org.apache.solr
    artifactId: solr-core
    version: 5.5.5
  exclusions:
  - name: slf4j-api
    version: 1.6.1
- id: branch_7_2
  coordinates:
    groupId: org.apache.solr
    artifactId: solr-core
    version: 7.0.0
  exclusions:
  - name: slf4j-api
    version: 1.6.1
- id: branch_6_6
  coordinates:
    groupId: org.apache.solr
    artifactId: solr-core
    version: 6.6.2
  exclusions:
  - name: slf4j-api
    version: 1.6.1
- id: branch_7_1
  coordinates:
    groupId: org.apache.solr
    artifactId: solr-core
    version: 7.1.0
  exclusions:
  - name: slf4j-api
    version: 1.6.1
artifacts:
- id: pkg:maven/org.apache.lucene/lucene-queryparser@7.1.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.solr/solr-core@8.4.0
  reason: Reviewed manually
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@8.3.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@8.1.1
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@8.5.1
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@6.1.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@4.6.1
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.solr/solr-core@8.0.0
  reason: Reviewed manually
  affected: false
- id: pkg:maven/org.apache.solr/solr-core@8.2.0
  reason: Reviewed manually
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@4.10.4
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@4.10.3
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@4.10.2
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@5.3.2
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@5.5.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@5.5.2
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@5.5.4
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@5.5.5
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@4.0.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@6.3.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@7.7.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@7.7.2
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@7.7.1
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@7.3.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@7.5.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@7.0.1
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@8.4.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.solr/solr-core@8.3.0
  reason: Reviewed manually
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@8.2.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.solr/solr-core@8.5.1
  reason: Reviewed manually
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@8.6.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@6.2.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@4.5.1
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@4.7.2
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@5.2.1
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.infinispan/infinispan-embedded-query@9.1.7.Final
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.solr/solr-core@7.7.1
  reason: Reviewed manually
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@5.4.1
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@6.6.5
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@6.6.2
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@6.6.1
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@6.4.2
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@6.6.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@6.4.1
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@6.2.1
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: true
- id: pkg:maven/org.apache.lucene/lucene-queryparser@8.0.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@7.2.1
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
- id: pkg:maven/org.apache.lucene/lucene-queryparser@7.4.0
  reason: Assessed with Eclipse Steady (AST_EQUALITY)
  affected: false
